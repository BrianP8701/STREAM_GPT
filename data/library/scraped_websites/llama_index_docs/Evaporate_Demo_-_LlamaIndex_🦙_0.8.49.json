{
    "metadata": {
        "type": "web",
        "url": "https://docs.llamaindex.ai/en/stable/examples/output_parsing/evaporate_program.html",
        "title": "Evaporate Demo - LlamaIndex \ud83e\udd99 0.8.49",
        "description": null
    },
    "text": "[Back to top](#)\n\nToggle table of contents sidebar\n\n## Evaporate Demo[\uf0c1](#evaporate-demo \"Permalink to this heading\")\n\nThis demo shows how you can extract DataFrame from raw text using the Evaporate paper (Arora et al.): https://arxiv.org/abs/2304.09433.\n\nThe inspiration is to first \u201cfit\u201d on a set of training text. The fitting process uses the LLM to generate a set of parsing functions from the text. These fitted functions are then applied to text during inference time.\n\n%load\\_ext autoreload\n%autoreload 2\n\nfrom llama\\_index import SimpleDirectoryReader, ServiceContext, LLMPredictor\nfrom llama\\_index.program.predefined import (\n    DFEvaporateProgram,\n    EvaporateExtractor,\n    MultiValueEvaporateProgram,\n)\nfrom llama\\_index.llms import OpenAI\nimport requests\n\n## Use `DFEvaporateProgram`[\uf0c1](#use-dfevaporateprogram \"Permalink to this heading\")\n\nThe `DFEvaporateProgram` will extract a 2D dataframe from a set of datapoints given a set of fields, and some training data to \u201cfit\u201d some functions on.\n\n### Load data[\uf0c1](#load-data \"Permalink to this heading\")\n\nHere we load a set of cities from Wikipedia.\n\nwiki\\_titles \\= \\[\"Toronto\", \"Seattle\", \"Chicago\", \"Boston\", \"Houston\"\\]\n\nfrom pathlib import Path\n\nimport requests\n\nfor title in wiki\\_titles:\n    response \\= requests.get(\n        \"https://en.wikipedia.org/w/api.php\",\n        params\\={\n            \"action\": \"query\",\n            \"format\": \"json\",\n            \"titles\": title,\n            \"prop\": \"extracts\",\n            \\# 'exintro': True,\n            \"explaintext\": True,\n        },\n    ).json()\n    page \\= next(iter(response\\[\"query\"\\]\\[\"pages\"\\].values()))\n    wiki\\_text \\= page\\[\"extract\"\\]\n\n    data\\_path \\= Path(\"data\")\n    if not data\\_path.exists():\n        Path.mkdir(data\\_path)\n\n    with open(data\\_path / f\"{title}.txt\", \"w\") as fp:\n        fp.write(wiki\\_text)\n\n\\# Load all wiki documents\ncity\\_docs \\= {}\nfor wiki\\_title in wiki\\_titles:\n    city\\_docs\\[wiki\\_title\\] \\= SimpleDirectoryReader(\n        input\\_files\\=\\[f\"data/{wiki\\_title}.txt\"\\]\n    ).load\\_data()\n\n### Parse Data[\uf0c1](#parse-data \"Permalink to this heading\")\n\n\\# setup service context\nllm \\= OpenAI(temperature\\=0, model\\=\"gpt-3.5-turbo\")\nservice\\_context \\= ServiceContext.from\\_defaults(llm\\=llm, chunk\\_size\\=512)\n\n\\# get nodes for each document\ncity\\_nodes \\= {}\nfor wiki\\_title in wiki\\_titles:\n    docs \\= city\\_docs\\[wiki\\_title\\]\n    nodes \\= service\\_context.node\\_parser.get\\_nodes\\_from\\_documents(docs)\n    city\\_nodes\\[wiki\\_title\\] \\= nodes\n\n### Running the DFEvaporateProgram[\uf0c1](#running-the-dfevaporateprogram \"Permalink to this heading\")\n\nHere we demonstrate how to extract datapoints with our `DFEvaporateProgram`. Given a set of fields, the `DFEvaporateProgram` can first fit functions on a set of training data, and then run extraction over inference data.\n\n\\# define program\nprogram \\= DFEvaporateProgram.from\\_defaults(\n    fields\\_to\\_extract\\=\\[\"population\"\\], service\\_context\\=service\\_context\n)\n\n### Fitting Functions[\uf0c1](#fitting-functions \"Permalink to this heading\")\n\nprogram.fit\\_fields(city\\_nodes\\[\"Toronto\"\\]\\[:1\\])\n\n{'population': 'def get\\_population\\_field(text: str):\\\\n    \"\"\"\\\\n    Function to extract population. \\\\n    \"\"\"\\\\n    \\\\n    # Use regex to find the population field\\\\n    pattern = r\\\\'(?<=population of )(\\\\\\\\d+,?\\\\\\\\d\\*)\\\\'\\\\n    population\\_field = re.search(pattern, text).group(1)\\\\n    \\\\n    # Return the population field as a single value\\\\n    return int(population\\_field.replace(\\\\',\\\\', \\\\'\\\\'))'}\n\n\\# view extracted function\nprint(program.get\\_function\\_str(\"population\"))\n\ndef get\\_population\\_field(text: str):\n    \"\"\"\n    Function to extract population. \n    \"\"\"\n    \n    # Use regex to find the population field\n    pattern = r'(?<=population of )(\\\\d+,?\\\\d\\*)'\n    population\\_field = re.search(pattern, text).group(1)\n    \n    # Return the population field as a single value\n    return int(population\\_field.replace(',', ''))\n\n### Run Inference[\uf0c1](#run-inference \"Permalink to this heading\")\n\nseattle\\_df \\= program(nodes\\=city\\_nodes\\[\"Seattle\"\\]\\[:1\\])\n\nDataFrameRowsOnly(rows=\\[DataFrameRow(row\\_values=\\[749256\\])\\])\n\n## Use `MultiValueEvaporateProgram`[\uf0c1](#use-multivalueevaporateprogram \"Permalink to this heading\")\n\nIn contrast to the `DFEvaporateProgram`, which assumes the output obeys a 2D tabular format (one row per node), the `MultiValueEvaporateProgram` returns a list of `DataFrameRow` objects - each object corresponds to a column, and can contain a variable length of values. This can help if we want to extract multiple values for one field from a given piece of text.\n\nIn this example, we use this program to parse gold medal counts.\n\nllm \\= OpenAI(temperature\\=0, model\\=\"gpt-4\")\nservice\\_context \\= ServiceContext.from\\_defaults(\n    llm\\=llm, chunk\\_size\\=1024, chunk\\_overlap\\=0\n)\n\n\\# Olympic total medal counts: https://en.wikipedia.org/wiki/All-time\\_Olympic\\_Games\\_medal\\_table\n\ntrain\\_text \\= \"\"\"\n<table class=\"wikitable sortable\" style=\"margin-top:0; text-align:center; font-size:90%;\">\n\n<tbody><tr>\n<th>Team (IOC code)\n</th>\n<th>No. Summer\n</th>\n<th>No. Winter\n</th>\n<th>No. Games\n</th></tr>\n<tr>\n<td align=\"left\"><span id=\"ALB\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/3/36/Flag\\_of\\_Albania.svg/22px-Flag\\_of\\_Albania.svg.png\" decoding=\"async\" width=\"22\" height=\"16\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/3/36/Flag\\_of\\_Albania.svg/33px-Flag\\_of\\_Albania.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/3/36/Flag\\_of\\_Albania.svg/44px-Flag\\_of\\_Albania.svg.png 2x\" data-file-width=\"980\" data-file-height=\"700\" />&#160;<a href=\"/wiki/Albania\\_at\\_the\\_Olympics\" title=\"Albania at the Olympics\">Albania</a>&#160;<span style=\"font-size:90%;\">(ALB)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">9</td>\n<td style=\"background:#cedff2;\">5</td>\n<td>14\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"ASA\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/8/87/Flag\\_of\\_American\\_Samoa.svg/22px-Flag\\_of\\_American\\_Samoa.svg.png\" decoding=\"async\" width=\"22\" height=\"11\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/8/87/Flag\\_of\\_American\\_Samoa.svg/33px-Flag\\_of\\_American\\_Samoa.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/8/87/Flag\\_of\\_American\\_Samoa.svg/44px-Flag\\_of\\_American\\_Samoa.svg.png 2x\" data-file-width=\"1000\" data-file-height=\"500\" />&#160;<a href=\"/wiki/American\\_Samoa\\_at\\_the\\_Olympics\" title=\"American Samoa at the Olympics\">American Samoa</a>&#160;<span style=\"font-size:90%;\">(ASA)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">9</td>\n<td style=\"background:#cedff2;\">2</td>\n<td>11\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"AND\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/1/19/Flag\\_of\\_Andorra.svg/22px-Flag\\_of\\_Andorra.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/1/19/Flag\\_of\\_Andorra.svg/33px-Flag\\_of\\_Andorra.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/1/19/Flag\\_of\\_Andorra.svg/44px-Flag\\_of\\_Andorra.svg.png 2x\" data-file-width=\"1000\" data-file-height=\"700\" />&#160;<a href=\"/wiki/Andorra\\_at\\_the\\_Olympics\" title=\"Andorra at the Olympics\">Andorra</a>&#160;<span style=\"font-size:90%;\">(AND)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">12</td>\n<td style=\"background:#cedff2;\">13</td>\n<td>25\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"ANG\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/9d/Flag\\_of\\_Angola.svg/22px-Flag\\_of\\_Angola.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/9d/Flag\\_of\\_Angola.svg/33px-Flag\\_of\\_Angola.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/9/9d/Flag\\_of\\_Angola.svg/44px-Flag\\_of\\_Angola.svg.png 2x\" data-file-width=\"900\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Angola\\_at\\_the\\_Olympics\" title=\"Angola at the Olympics\">Angola</a>&#160;<span style=\"font-size:90%;\">(ANG)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">10</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>10\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"ANT\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/8/89/Flag\\_of\\_Antigua\\_and\\_Barbuda.svg/22px-Flag\\_of\\_Antigua\\_and\\_Barbuda.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/8/89/Flag\\_of\\_Antigua\\_and\\_Barbuda.svg/33px-Flag\\_of\\_Antigua\\_and\\_Barbuda.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/8/89/Flag\\_of\\_Antigua\\_and\\_Barbuda.svg/44px-Flag\\_of\\_Antigua\\_and\\_Barbuda.svg.png 2x\" data-file-width=\"900\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Antigua\\_and\\_Barbuda\\_at\\_the\\_Olympics\" title=\"Antigua and Barbuda at the Olympics\">Antigua and Barbuda</a>&#160;<span style=\"font-size:90%;\">(ANT)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">11</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>11\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"ARU\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Flag\\_of\\_Aruba.svg/22px-Flag\\_of\\_Aruba.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Flag\\_of\\_Aruba.svg/33px-Flag\\_of\\_Aruba.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Flag\\_of\\_Aruba.svg/44px-Flag\\_of\\_Aruba.svg.png 2x\" data-file-width=\"900\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Aruba\\_at\\_the\\_Olympics\" title=\"Aruba at the Olympics\">Aruba</a>&#160;<span style=\"font-size:90%;\">(ARU)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">9</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>9\n</td></tr>\n\"\"\"\ntrain\\_nodes \\= \\[Node(text\\=train\\_text)\\]\n\ninfer\\_text \\= \"\"\"\n<td align=\"left\"><span id=\"BAN\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/f/f9/Flag\\_of\\_Bangladesh.svg/22px-Flag\\_of\\_Bangladesh.svg.png\" decoding=\"async\" width=\"22\" height=\"13\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/f/f9/Flag\\_of\\_Bangladesh.svg/33px-Flag\\_of\\_Bangladesh.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/f9/Flag\\_of\\_Bangladesh.svg/44px-Flag\\_of\\_Bangladesh.svg.png 2x\" data-file-width=\"1000\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Bangladesh\\_at\\_the\\_Olympics\" title=\"Bangladesh at the Olympics\">Bangladesh</a>&#160;<span style=\"font-size:90%;\">(BAN)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">10</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>10\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"BIZ\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/e/e7/Flag\\_of\\_Belize.svg/22px-Flag\\_of\\_Belize.svg.png\" decoding=\"async\" width=\"22\" height=\"13\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/e/e7/Flag\\_of\\_Belize.svg/33px-Flag\\_of\\_Belize.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/e/e7/Flag\\_of\\_Belize.svg/44px-Flag\\_of\\_Belize.svg.png 2x\" data-file-width=\"1000\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Belize\\_at\\_the\\_Olympics\" title=\"Belize at the Olympics\">Belize</a>&#160;<span style=\"font-size:90%;\">(BIZ)</span></span> <sup class=\"reference\" id=\"ref\\_BIZBIZ\"><a href=\"#endnote\\_BIZBIZ\">\\[BIZ\\]</a></sup>\n</td>\n<td style=\"background:#f2f2ce;\">13</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>13\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"BEN\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Flag\\_of\\_Benin.svg/22px-Flag\\_of\\_Benin.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Flag\\_of\\_Benin.svg/33px-Flag\\_of\\_Benin.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Flag\\_of\\_Benin.svg/44px-Flag\\_of\\_Benin.svg.png 2x\" data-file-width=\"900\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Benin\\_at\\_the\\_Olympics\" title=\"Benin at the Olympics\">Benin</a>&#160;<span style=\"font-size:90%;\">(BEN)</span></span> <sup class=\"reference\" id=\"ref\\_BENBEN\"><a href=\"#endnote\\_BENBEN\">\\[BEN\\]</a></sup>\n</td>\n<td style=\"background:#f2f2ce;\">12</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>12\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"BHU\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/91/Flag\\_of\\_Bhutan.svg/22px-Flag\\_of\\_Bhutan.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/91/Flag\\_of\\_Bhutan.svg/33px-Flag\\_of\\_Bhutan.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/9/91/Flag\\_of\\_Bhutan.svg/44px-Flag\\_of\\_Bhutan.svg.png 2x\" data-file-width=\"900\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Bhutan\\_at\\_the\\_Olympics\" title=\"Bhutan at the Olympics\">Bhutan</a>&#160;<span style=\"font-size:90%;\">(BHU)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">10</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>10\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"BOL\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/4/48/Flag\\_of\\_Bolivia.svg/22px-Flag\\_of\\_Bolivia.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/4/48/Flag\\_of\\_Bolivia.svg/33px-Flag\\_of\\_Bolivia.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/4/48/Flag\\_of\\_Bolivia.svg/44px-Flag\\_of\\_Bolivia.svg.png 2x\" data-file-width=\"1100\" data-file-height=\"750\" />&#160;<a href=\"/wiki/Bolivia\\_at\\_the\\_Olympics\" title=\"Bolivia at the Olympics\">Bolivia</a>&#160;<span style=\"font-size:90%;\">(BOL)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">15</td>\n<td style=\"background:#cedff2;\">7</td>\n<td>22\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"BIH\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Flag\\_of\\_Bosnia\\_and\\_Herzegovina.svg/22px-Flag\\_of\\_Bosnia\\_and\\_Herzegovina.svg.png\" decoding=\"async\" width=\"22\" height=\"11\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Flag\\_of\\_Bosnia\\_and\\_Herzegovina.svg/33px-Flag\\_of\\_Bosnia\\_and\\_Herzegovina.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Flag\\_of\\_Bosnia\\_and\\_Herzegovina.svg/44px-Flag\\_of\\_Bosnia\\_and\\_Herzegovina.svg.png 2x\" data-file-width=\"800\" data-file-height=\"400\" />&#160;<a href=\"/wiki/Bosnia\\_and\\_Herzegovina\\_at\\_the\\_Olympics\" title=\"Bosnia and Herzegovina at the Olympics\">Bosnia and Herzegovina</a>&#160;<span style=\"font-size:90%;\">(BIH)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">8</td>\n<td style=\"background:#cedff2;\">8</td>\n<td>16\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"IVB\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/4/42/Flag\\_of\\_the\\_British\\_Virgin\\_Islands.svg/22px-Flag\\_of\\_the\\_British\\_Virgin\\_Islands.svg.png\" decoding=\"async\" width=\"22\" height=\"11\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/4/42/Flag\\_of\\_the\\_British\\_Virgin\\_Islands.svg/33px-Flag\\_of\\_the\\_British\\_Virgin\\_Islands.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/4/42/Flag\\_of\\_the\\_British\\_Virgin\\_Islands.svg/44px-Flag\\_of\\_the\\_British\\_Virgin\\_Islands.svg.png 2x\" data-file-width=\"1200\" data-file-height=\"600\" />&#160;<a href=\"/wiki/British\\_Virgin\\_Islands\\_at\\_the\\_Olympics\" title=\"British Virgin Islands at the Olympics\">British Virgin Islands</a>&#160;<span style=\"font-size:90%;\">(IVB)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">10</td>\n<td style=\"background:#cedff2;\">2</td>\n<td>12\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"BRU\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Flag\\_of\\_Brunei.svg/22px-Flag\\_of\\_Brunei.svg.png\" decoding=\"async\" width=\"22\" height=\"11\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Flag\\_of\\_Brunei.svg/33px-Flag\\_of\\_Brunei.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Flag\\_of\\_Brunei.svg/44px-Flag\\_of\\_Brunei.svg.png 2x\" data-file-width=\"1440\" data-file-height=\"720\" />&#160;<a href=\"/wiki/Brunei\\_at\\_the\\_Olympics\" title=\"Brunei at the Olympics\">Brunei</a>&#160;<span style=\"font-size:90%;\">(BRU)</span></span> <sup class=\"reference\" id=\"ref\\_AA\"><a href=\"#endnote\\_AA\">\\[A\\]</a></sup>\n</td>\n<td style=\"background:#f2f2ce;\">6</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>6\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"CAM\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/8/83/Flag\\_of\\_Cambodia.svg/22px-Flag\\_of\\_Cambodia.svg.png\" decoding=\"async\" width=\"22\" height=\"14\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/8/83/Flag\\_of\\_Cambodia.svg/33px-Flag\\_of\\_Cambodia.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/8/83/Flag\\_of\\_Cambodia.svg/44px-Flag\\_of\\_Cambodia.svg.png 2x\" data-file-width=\"1000\" data-file-height=\"640\" />&#160;<a href=\"/wiki/Cambodia\\_at\\_the\\_Olympics\" title=\"Cambodia at the Olympics\">Cambodia</a>&#160;<span style=\"font-size:90%;\">(CAM)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">10</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>10\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"CPV\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/3/38/Flag\\_of\\_Cape\\_Verde.svg/22px-Flag\\_of\\_Cape\\_Verde.svg.png\" decoding=\"async\" width=\"22\" height=\"13\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/3/38/Flag\\_of\\_Cape\\_Verde.svg/33px-Flag\\_of\\_Cape\\_Verde.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/3/38/Flag\\_of\\_Cape\\_Verde.svg/44px-Flag\\_of\\_Cape\\_Verde.svg.png 2x\" data-file-width=\"1020\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Cape\\_Verde\\_at\\_the\\_Olympics\" title=\"Cape Verde at the Olympics\">Cape Verde</a>&#160;<span style=\"font-size:90%;\">(CPV)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">7</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>7\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"CAY\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0f/Flag\\_of\\_the\\_Cayman\\_Islands.svg/22px-Flag\\_of\\_the\\_Cayman\\_Islands.svg.png\" decoding=\"async\" width=\"22\" height=\"11\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0f/Flag\\_of\\_the\\_Cayman\\_Islands.svg/33px-Flag\\_of\\_the\\_Cayman\\_Islands.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/0/0f/Flag\\_of\\_the\\_Cayman\\_Islands.svg/44px-Flag\\_of\\_the\\_Cayman\\_Islands.svg.png 2x\" data-file-width=\"1200\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Cayman\\_Islands\\_at\\_the\\_Olympics\" title=\"Cayman Islands at the Olympics\">Cayman Islands</a>&#160;<span style=\"font-size:90%;\">(CAY)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">11</td>\n<td style=\"background:#cedff2;\">2</td>\n<td>13\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"CAF\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Flag\\_of\\_the\\_Central\\_African\\_Republic.svg/22px-Flag\\_of\\_the\\_Central\\_African\\_Republic.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Flag\\_of\\_the\\_Central\\_African\\_Republic.svg/33px-Flag\\_of\\_the\\_Central\\_African\\_Republic.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Flag\\_of\\_the\\_Central\\_African\\_Republic.svg/44px-Flag\\_of\\_the\\_Central\\_African\\_Republic.svg.png 2x\" data-file-width=\"900\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Central\\_African\\_Republic\\_at\\_the\\_Olympics\" title=\"Central African Republic at the Olympics\">Central African Republic</a>&#160;<span style=\"font-size:90%;\">(CAF)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">11</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>11\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"CHA\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/4/4b/Flag\\_of\\_Chad.svg/22px-Flag\\_of\\_Chad.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/4/4b/Flag\\_of\\_Chad.svg/33px-Flag\\_of\\_Chad.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/4/4b/Flag\\_of\\_Chad.svg/44px-Flag\\_of\\_Chad.svg.png 2x\" data-file-width=\"900\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Chad\\_at\\_the\\_Olympics\" title=\"Chad at the Olympics\">Chad</a>&#160;<span style=\"font-size:90%;\">(CHA)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">13</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>13\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"COM\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/94/Flag\\_of\\_the\\_Comoros.svg/22px-Flag\\_of\\_the\\_Comoros.svg.png\" decoding=\"async\" width=\"22\" height=\"13\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/94/Flag\\_of\\_the\\_Comoros.svg/33px-Flag\\_of\\_the\\_Comoros.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/9/94/Flag\\_of\\_the\\_Comoros.svg/44px-Flag\\_of\\_the\\_Comoros.svg.png 2x\" data-file-width=\"1000\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Comoros\\_at\\_the\\_Olympics\" title=\"Comoros at the Olympics\">Comoros</a>&#160;<span style=\"font-size:90%;\">(COM)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">7</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>7\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"CGO\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/92/Flag\\_of\\_the\\_Republic\\_of\\_the\\_Congo.svg/22px-Flag\\_of\\_the\\_Republic\\_of\\_the\\_Congo.svg.png\" decoding=\"async\" width=\"22\" height=\"15\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/9/92/Flag\\_of\\_the\\_Republic\\_of\\_the\\_Congo.svg/33px-Flag\\_of\\_the\\_Republic\\_of\\_the\\_Congo.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/9/92/Flag\\_of\\_the\\_Republic\\_of\\_the\\_Congo.svg/44px-Flag\\_of\\_the\\_Republic\\_of\\_the\\_Congo.svg.png 2x\" data-file-width=\"900\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Republic\\_of\\_the\\_Congo\\_at\\_the\\_Olympics\" title=\"Republic of the Congo at the Olympics\">Republic of the Congo</a>&#160;<span style=\"font-size:90%;\">(CGO)</span></span>\n</td>\n<td style=\"background:#f2f2ce;\">13</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>13\n</td></tr>\n<tr>\n<td align=\"left\"><span id=\"COD\"><img alt=\"\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Flag\\_of\\_the\\_Democratic\\_Republic\\_of\\_the\\_Congo.svg/22px-Flag\\_of\\_the\\_Democratic\\_Republic\\_of\\_the\\_Congo.svg.png\" decoding=\"async\" width=\"22\" height=\"17\" class=\"thumbborder\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Flag\\_of\\_the\\_Democratic\\_Republic\\_of\\_the\\_Congo.svg/33px-Flag\\_of\\_the\\_Democratic\\_Republic\\_of\\_the\\_Congo.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Flag\\_of\\_the\\_Democratic\\_Republic\\_of\\_the\\_Congo.svg/44px-Flag\\_of\\_the\\_Democratic\\_Republic\\_of\\_the\\_Congo.svg.png 2x\" data-file-width=\"800\" data-file-height=\"600\" />&#160;<a href=\"/wiki/Democratic\\_Republic\\_of\\_the\\_Congo\\_at\\_the\\_Olympics\" title=\"Democratic Republic of the Congo at the Olympics\">Democratic Republic of the Congo</a>&#160;<span style=\"font-size:90%;\">(COD)</span></span> <sup class=\"reference\" id=\"ref\\_CODCOD\"><a href=\"#endnote\\_CODCOD\">\\[COD\\]</a></sup>\n</td>\n<td style=\"background:#f2f2ce;\">11</td>\n<td style=\"background:#cedff2;\">0</td>\n<td>11\n</td></tr>\n\"\"\"\n\ninfer\\_nodes \\= \\[Node(text\\=infer\\_text)\\]\n\nfrom llama\\_index.program.predefined import MultiValueEvaporateProgram\n\nprogram \\= MultiValueEvaporateProgram.from\\_defaults(\n    fields\\_to\\_extract\\=\\[\"countries\", \"medal\\_count\"\\],\n    service\\_context\\=service\\_context,\n)\n\nprogram.fit\\_fields(train\\_nodes\\[:1\\])\n\n{'countries': 'def get\\_countries\\_field(text: str):\\\\n    \"\"\"\\\\n    Function to extract countries. \\\\n    \"\"\"\\\\n    \\\\n    # Use regex to extract the countries field\\\\n    countries\\_field = re.findall(r\\\\'<a href=\".\\*\">(.\\*)</a>\\\\', text)\\\\n    \\\\n    # Return the result as a list\\\\n    return countries\\_field',\n 'medal\\_count': 'def get\\_medal\\_count\\_field(text: str):\\\\n    \"\"\"\\\\n    Function to extract medal\\_count. \\\\n    \"\"\"\\\\n    \\\\n    # Use regex to extract the medal count field\\\\n    medal\\_count\\_field = re.findall(r\\\\'<td style=\"background:#f2f2ce;\">(.\\*?)</td>\\\\', text)\\\\n    \\\\n    # Return the result as a list\\\\n    return medal\\_count\\_field'}\n\nprint(program.get\\_function\\_str(\"countries\"))\n\ndef get\\_countries\\_field(text: str):\n    \"\"\"\n    Function to extract countries. \n    \"\"\"\n    \n    # Use regex to extract the countries field\n    countries\\_field = re.findall(r'<a href=\".\\*\">(.\\*)</a>', text)\n    \n    # Return the result as a list\n    return countries\\_field\n\nprint(program.get\\_function\\_str(\"medal\\_count\"))\n\ndef get\\_medal\\_count\\_field(text: str):\n    \"\"\"\n    Function to extract medal\\_count. \n    \"\"\"\n    \n    # Use regex to extract the medal count field\n    medal\\_count\\_field = re.findall(r'<td style=\"background:#f2f2ce;\">(.\\*?)</td>', text)\n    \n    # Return the result as a list\n    return medal\\_count\\_field\n\nresult \\= program(nodes\\=infer\\_nodes\\[:1\\])\n\n\\# output countries\nprint(f\"Countries: {result.columns\\[0\\].row\\_values}\\\\n\")\n\\# output medal counts\nprint(f\"Medal Counts: {result.columns\\[0\\].row\\_values}\\\\n\")\n\nCountries: \\['Bangladesh', '\\[BIZ\\]', '\\[BEN\\]', 'Bhutan', 'Bolivia', 'Bosnia and Herzegovina', 'British Virgin Islands', '\\[A\\]', 'Cambodia', 'Cape Verde', 'Cayman Islands', 'Central African Republic', 'Chad', 'Comoros', 'Republic of the Congo', '\\[COD\\]'\\]\n\nMedal Counts: \\['Bangladesh', '\\[BIZ\\]', '\\[BEN\\]', 'Bhutan', 'Bolivia', 'Bosnia and Herzegovina', 'British Virgin Islands', '\\[A\\]', 'Cambodia', 'Cape Verde', 'Cayman Islands', 'Central African Republic', 'Chad', 'Comoros', 'Republic of the Congo', '\\[COD\\]'\\]"
}