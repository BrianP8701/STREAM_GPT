{
    "metadata": {
        "type": "web",
        "url": "https://docs.llamaindex.ai/en/stable/examples/composable_indices/city_analysis/City_Analysis-Decompose.html",
        "title": "Test Complex Queries over Multiple Documents (with and without Query Decomposition) - LlamaIndex \ud83e\udd99 0.8.49",
        "description": null
    },
    "text": "[Back to top](#)\n\nToggle table of contents sidebar\n\nQuery Decomposition: The ability to decompose a complex query into a simpler query given the content of the index.\n\nUse ChatGPT as the LLM model\n\nimport logging\n\n\\# logging.basicConfig(stream=sys.stdout, level=logging.INFO)\n\\# logging.getLogger().addHandler(logging.StreamHandler(stream=sys.stdout))\n\n\\# Uncomment if you want to temporarily disable logger\nlogger \\= logging.getLogger()\nlogger.disabled \\= True\n\nfrom llama\\_index import (\n    VectorStoreIndex,\n    SimpleKeywordTableIndex,\n    SimpleDirectoryReader,\n    ServiceContext,\n)\n\n/Users/suo/miniconda3/envs/llama/lib/python3.9/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user\\_install.html\n  from .autonotebook import tqdm as notebook\\_tqdm\n\n## Load Datasets[\uf0c1](#load-datasets \"Permalink to this heading\")\n\nLoad Wikipedia pages as well as Paul Graham\u2019s \u201cWhat I Worked On\u201d essay\n\nwiki\\_titles \\= \\[\n    \"Toronto\",\n    \"Seattle\",\n    \"San Francisco\",\n    \"Chicago\",\n    \"Boston\",\n    \"Washington, D.C.\",\n    \"Cambridge, Massachusetts\",\n    \"Houston\",\n\\]\n\nfrom pathlib import Path\n\nimport requests\n\nfor title in wiki\\_titles:\n    response \\= requests.get(\n        \"https://en.wikipedia.org/w/api.php\",\n        params\\={\n            \"action\": \"query\",\n            \"format\": \"json\",\n            \"titles\": title,\n            \"prop\": \"extracts\",\n            \\# 'exintro': True,\n            \"explaintext\": True,\n        },\n    ).json()\n    page \\= next(iter(response\\[\"query\"\\]\\[\"pages\"\\].values()))\n    wiki\\_text \\= page\\[\"extract\"\\]\n\n    data\\_path \\= Path(\"data\")\n    if not data\\_path.exists():\n        Path.mkdir(data\\_path)\n\n    with open(data\\_path / f\"{title}.txt\", \"w\") as fp:\n        fp.write(wiki\\_text)\n\n\\# Load all wiki documents\ncity\\_docs \\= {}\nfor wiki\\_title in wiki\\_titles:\n    city\\_docs\\[wiki\\_title\\] \\= SimpleDirectoryReader(\n        input\\_files\\=\\[f\"data/{wiki\\_title}.txt\"\\]\n    ).load\\_data()\n\n## Building the document indices[\uf0c1](#building-the-document-indices \"Permalink to this heading\")\n\nBuild a vector index for the wiki pages about cities and persons, and PG essay\n\n\\# # LLM Predictor (gpt-3.5-turbo)\nfrom llama\\_index.llms.openai import OpenAI\n\nchatgpt \\= OpenAI(temperature\\=0, model\\=\"gpt-3.5-turbo\")\nservice\\_context \\= ServiceContext.from\\_defaults(llm\\=chatgpt)\n\n/Users/suo/miniconda3/envs/llama/lib/python3.9/site-packages/langchain/llms/openai.py:661: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: \\`from langchain.chat\\_models import ChatOpenAI\\`\n  warnings.warn(\n\n\\# Build city document index\ncity\\_indices \\= {}\nindex\\_summaries \\= {}\nfor wiki\\_title in wiki\\_titles:\n    city\\_indices\\[wiki\\_title\\] \\= VectorStoreIndex.from\\_documents(\n        city\\_docs\\[wiki\\_title\\], service\\_context\\=service\\_context\n    )\n    \\# set summary text for city\n    index\\_summaries\\[wiki\\_title\\] \\= f\"Wikipedia articles about {wiki\\_title}\"\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total embedding token usage: 20744 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total embedding token usage: 16942 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total embedding token usage: 23433 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total embedding token usage: 26082 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total embedding token usage: 18614 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total embedding token usage: 21649 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total embedding token usage: 12855 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total embedding token usage: 21844 tokens\n\n## Build Graph: Keyword Table Index on top of vector indices![\uf0c1](#build-graph-keyword-table-index-on-top-of-vector-indices \"Permalink to this heading\")\n\nWe compose a keyword table index on top of all the vector indices.\n\nfrom llama\\_index.indices.composability import ComposableGraph\n\ngraph \\= ComposableGraph.from\\_indices(\n    SimpleKeywordTableIndex,\n    \\[index for \\_, index in city\\_indices.items()\\],\n    \\[summary for \\_, summary in index\\_summaries.items()\\],\n    max\\_keywords\\_per\\_chunk\\=50,\n)\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[build\\_index\\_from\\_nodes\\] Total embedding token usage: 0 tokens\n\n## Define Query Configs[\uf0c1](#define-query-configs \"Permalink to this heading\")\n\n**Query Transform**\n\nfrom llama\\_index.indices.query.query\\_transform.base import (\n    DecomposeQueryTransform,\n)\n\ndecompose\\_transform \\= DecomposeQueryTransform(\n    service\\_context.llm\\_predictor, verbose\\=True\n)\n\n**Complex Query 1**\n\n\\# with query decomposition in subindices\nfrom llama\\_index.query\\_engine.transform\\_query\\_engine import (\n    TransformQueryEngine,\n)\n\ncustom\\_query\\_engines \\= {}\nfor index in city\\_indices.values():\n    query\\_engine \\= index.as\\_query\\_engine(service\\_context\\=service\\_context)\n    transform\\_metadata \\= {\"index\\_summary\": index.index\\_struct.summary}\n    tranformed\\_query\\_engine \\= TransformQueryEngine(\n        query\\_engine,\n        decompose\\_transform,\n        transform\\_metadata\\=transform\\_metadata,\n    )\n    custom\\_query\\_engines\\[index.index\\_id\\] \\= tranformed\\_query\\_engine\n\ncustom\\_query\\_engines\\[\n    graph.root\\_index.index\\_id\n\\] \\= graph.root\\_index.as\\_query\\_engine(\n    retriever\\_mode\\=\"simple\",\n    response\\_mode\\=\"tree\\_summarize\",\n    service\\_context\\=service\\_context,\n)\n\nquery\\_engine\\_decompose \\= graph.as\\_query\\_engine(\n    custom\\_query\\_engines\\=custom\\_query\\_engines,\n)\n\nresponse\\_chatgpt \\= query\\_engine\\_decompose.query(\n    \"Compare and contrast the airports in Seattle, Houston, and Toronto. \"\n)\n\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Starting query: Compare and contrast the airports in Seattle, Houston, and Toronto. \nINFO:llama\\_index.indices.keyword\\_table.retrievers:query keywords: \\['toronto', 'airports', 'seattle', 'contrast', 'compare', 'houston'\\]\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Extracted keywords: \\['toronto', 'seattle', 'houston'\\]\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 12 tokens\n\n\\> Current query: Compare and contrast the airports in Seattle, Houston, and Toronto. \n\\> New query: What are some notable features of the Toronto Pearson International Airport?\n\\> Current query: Compare and contrast the airports in Seattle, Houston, and Toronto. \n\\> New query: What are some notable features of the Toronto Pearson International Airport?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1142 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1142 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 10 tokens\n\n\\> Current query: Compare and contrast the airports in Seattle, Houston, and Toronto. \n\\> New query: What is the name of the airport in Seattle?\n\\> Current query: Compare and contrast the airports in Seattle, Houston, and Toronto. \n\\> New query: What is the name of the airport in Seattle?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1773 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1773 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\n\\> Current query: Compare and contrast the airports in Seattle, Houston, and Toronto. \n\\> New query: What are the major airports in Houston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 8 tokens\n\n\\> Current query: Compare and contrast the airports in Seattle, Houston, and Toronto. \n\\> New query: What are the major airports in Houston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1162 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1162 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 254 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 254 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\nprint(str(response\\_chatgpt))\n\nSeattle has one major airport called Seattle-Tacoma International Airport, while Houston has two major airports called George Bush Intercontinental Airport and William P. Hobby Airport, as well as a third municipal airport called Ellington Airport. Toronto Pearson International Airport is Canada's busiest airport and offers limited commercial and passenger service to nearby destinations in Canada and the United States. All three cities have at least one major airport, but Houston has more options with two major airports.\n\n\\# without query decomposition in subindices\n\ncustom\\_query\\_engines \\= {}\nfor index in city\\_indices.values():\n    query\\_engine \\= index.as\\_query\\_engine(service\\_context\\=service\\_context)\n    custom\\_query\\_engines\\[index.index\\_id\\] \\= query\\_engine\n\ncustom\\_query\\_engines\\[\n    graph.root\\_index.index\\_id\n\\] \\= graph.root\\_index.as\\_query\\_engine(\n    retriever\\_mode\\=\"simple\",\n    response\\_mode\\=\"tree\\_summarize\",\n    service\\_context\\=service\\_context,\n)\n\nquery\\_engine \\= graph.as\\_query\\_engine(\n    custom\\_query\\_engines\\=custom\\_query\\_engines,\n)\n\nresponse\\_chatgpt \\= query\\_engine.query(\n    \"Compare and contrast the airports in Seattle, Houston, and Toronto. \"\n)\n\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Starting query: Compare and contrast the airports in Seattle, Houston, and Toronto. \nINFO:llama\\_index.indices.keyword\\_table.retrievers:query keywords: \\['toronto', 'airports', 'seattle', 'contrast', 'compare', 'houston'\\]\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Extracted keywords: \\['toronto', 'seattle', 'houston'\\]\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 14 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1114 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1114 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1799 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1799 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1186 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1186 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 196 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 196 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\n'It is not possible to compare and contrast the airports in Seattle, Houston, and Toronto based on the given context information.'\n\n**Complex Query 2**\n\n\\# with query decomposition\nresponse\\_chatgpt \\= query\\_engine\\_decompose.query(\n    \"Compare and contrast the sports environment of Houston and Boston. \"\n)\n\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Starting query: Compare and contrast the sports environment of Houston and Boston. \nINFO:llama\\_index.indices.keyword\\_table.retrievers:query keywords: \\['environment', 'contrast', 'sports', 'compare', 'houston', 'boston'\\]\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Extracted keywords: \\['houston', 'boston'\\]\n\n\\> Current query: Compare and contrast the sports environment of Houston and Boston. \n\\> New query: What sports teams are based in Houston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 8 tokens\n\n\\> Current query: Compare and contrast the sports environment of Houston and Boston. \n\\> New query: What sports teams are based in Houston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1861 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1861 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 10 tokens\n\n\\> Current query: Compare and contrast the sports environment of Houston and Boston. \n\\> New query: What are some notable sports teams based in Boston?\n\\> Current query: Compare and contrast the sports environment of Houston and Boston. \n\\> New query: What are some notable sports teams based in Boston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1812 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1812 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 226 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 226 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\n'Houston has sports teams for every major professional league except the National Hockey League, while Boston has teams for Major League Baseball, National Hockey League, National Basketball Association, National Football League, Major League Lacrosse, and Overwatch League. Both cities have a strong sports culture, but Boston has a more diverse range of professional sports teams.'\n\n\\# without query decomposition\nresponse\\_chatgpt \\= query\\_engine.query(\n    \"Compare and contrast the sports environment of Houston and Boston. \"\n)\n\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Starting query: Compare and contrast the sports environment of Houston and Boston. \nINFO:llama\\_index.indices.keyword\\_table.retrievers:query keywords: \\['environment', 'contrast', 'sports', 'compare', 'houston', 'boston'\\]\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Extracted keywords: \\['houston', 'boston'\\]\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 12 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1795 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1795 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1792 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1792 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 119 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 119 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\n'Sorry, I cannot answer this question as there is no information provided about the sports environment of Houston or Boston in the given context information.'\n\n\\# with query decomposition\nresponse\\_chatgpt \\= query\\_engine\\_decompose.query(\n    \"Compare and contrast the sports environment of Houston and Boston. \"\n)\n\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Starting query: Compare and contrast the sports environment of Houston and Boston. \nINFO:llama\\_index.indices.keyword\\_table.retrievers:query keywords: \\['environment', 'contrast', 'sports', 'compare', 'houston', 'boston'\\]\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Extracted keywords: \\['houston', 'boston'\\]\n\n\\> Current query: Compare and contrast the sports environment of Houston and Boston. \n\\> New query: What sports teams are based in Houston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 8 tokens\n\n\\> Current query: Compare and contrast the sports environment of Houston and Boston. \n\\> New query: What sports teams are based in Houston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1861 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1861 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\n\\> Current query: Compare and contrast the sports environment of Houston and Boston. \n\\> New query: What are some notable sports teams based in Boston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 10 tokens\n\n\\> Current query: Compare and contrast the sports environment of Houston and Boston. \n\\> New query: What are some notable sports teams based in Boston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1812 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1812 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 226 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 226 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\nHouston has sports teams for every major professional league except the National Hockey League, while Boston has teams for Major League Baseball, National Hockey League, National Basketball Association, National Football League, Major League Lacrosse, and Overwatch League. Both cities have a strong sports culture, but Boston has a more diverse range of professional sports teams.\n\n\\# without query decomposition\nresponse\\_chatgpt \\= query\\_engine.query(\n    \"Compare and contrast the sports environment of Houston and Boston. \"\n)\n\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Starting query: Compare and contrast the sports environment of Houston and Boston. \nINFO:llama\\_index.indices.keyword\\_table.retrievers:query keywords: \\['environment', 'contrast', 'sports', 'compare', 'houston', 'boston'\\]\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Extracted keywords: \\['houston', 'boston'\\]\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 12 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1795 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1795 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1792 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1792 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 119 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 119 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\nSorry, I cannot answer this question as there is no information provided about the sports environment of Houston or Boston in the given context information.\n\n**Complex Query 3**\n\n\\# with query decomposition\nresponse\\_chatgpt \\= query\\_engine\\_decompose.query(\n    \"Compare and contrast the arts and culture of Houston and Boston. \"\n)\n\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Starting query: Compare and contrast the arts and culture of Houston and Boston. \nINFO:llama\\_index.indices.keyword\\_table.retrievers:query keywords: \\['arts', 'culture', 'contrast', 'compare', 'houston', 'boston'\\]\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Extracted keywords: \\['houston', 'boston'\\]\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 9 tokens\n\n\\> Current query: Compare and contrast the arts and culture of Houston and Boston. \n\\> New query: What are some notable cultural institutions in Houston?\n\\> Current query: Compare and contrast the arts and culture of Houston and Boston. \n\\> New query: What are some notable cultural institutions in Houston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1835 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1835 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\n\\> Current query: Compare and contrast the arts and culture of Houston and Boston. \n\\> New query: What are some notable cultural institutions in Boston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 9 tokens\n\n\\> Current query: Compare and contrast the arts and culture of Houston and Boston. \n\\> New query: What are some notable cultural institutions in Boston?\n\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1918 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1918 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 444 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 444 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\nBoth Houston and Boston have a variety of cultural institutions, including museums, performing arts organizations, and theaters. Some notable museums in both cities include the Museum of Fine Arts. However, Houston has a greater focus on contemporary art with institutions such as the Contemporary Arts Museum Houston and the Station Museum of Contemporary Art. Boston, on the other hand, has a unique museum in the Isabella Stewart Gardner Museum, which features a collection of art and artifacts in a recreated Venetian palace. In terms of performing arts, both cities have symphony orchestras and opera companies, but Boston also has a strong focus on contemporary classical music with groups such as the Boston Modern Orchestra Project. Overall, while both cities have a rich arts and culture scene, they differ in their specific areas of focus.\n\n\\# without query decomposition\nresponse\\_chatgpt \\= query\\_engine.query(\n    \"Compare and contrast the arts and culture of Houston and Boston. \"\n)\n\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Starting query: Compare and contrast the arts and culture of Houston and Boston. \nINFO:llama\\_index.indices.keyword\\_table.retrievers:query keywords: \\['arts', 'culture', 'contrast', 'compare', 'houston', 'boston'\\]\nINFO:llama\\_index.indices.keyword\\_table.retrievers:> Extracted keywords: \\['houston', 'boston'\\]\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 13 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1779 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1779 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total LLM token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[retrieve\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1817 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 1817 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 122 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total LLM token usage: 122 tokens\nINFO:llama\\_index.token\\_counter.token\\_counter:> \\[get\\_response\\] Total embedding token usage: 0 tokens\n\nI'm sorry, but there is not enough information provided to compare and contrast the arts and culture of Houston and Boston."
}