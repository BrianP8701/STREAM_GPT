{
    "metadata": {
        "type": "web",
        "url": "https://docs.llamaindex.ai/en/stable/examples/usecases/10q_sub_question.html",
        "title": "10Q Analysis - LlamaIndex \ud83e\udd99 0.8.49",
        "description": null
    },
    "text": "[Back to top](#)\n\nToggle table of contents sidebar\n\n## 10Q Analysis[\uf0c1](#q-analysis \"Permalink to this heading\")\n\nIn this demo, we explore answering complex queries by decomposing them into simpler sub-queries.\n\nimport nest\\_asyncio\n\nnest\\_asyncio.apply()\n\nfrom llama\\_index import SimpleDirectoryReader, ServiceContext, VectorStoreIndex\nfrom llama\\_index.response.pprint\\_utils import pprint\\_response\nfrom llama\\_index.llms import OpenAI\n\nfrom llama\\_index.tools import QueryEngineTool, ToolMetadata\nfrom llama\\_index.query\\_engine import SubQuestionQueryEngine\n\n## Configure LLM service[\uf0c1](#configure-llm-service \"Permalink to this heading\")\n\nllm \\= OpenAI(temperature\\=0, model\\=\"text-davinci-003\", max\\_tokens\\=-1)\nservice\\_context \\= ServiceContext.from\\_defaults(llm\\=llm)\n\n## Load data[\uf0c1](#load-data \"Permalink to this heading\")\n\nmarch\\_2022 \\= SimpleDirectoryReader(\n    input\\_files\\=\\[\"../data/10q/uber\\_10q\\_march\\_2022.pdf\"\\]\n).load\\_data()\njune\\_2022 \\= SimpleDirectoryReader(\n    input\\_files\\=\\[\"../data/10q/uber\\_10q\\_june\\_2022.pdf\"\\]\n).load\\_data()\nsept\\_2022 \\= SimpleDirectoryReader(\n    input\\_files\\=\\[\"../data/10q/uber\\_10q\\_sept\\_2022.pdf\"\\]\n).load\\_data()\n\n## Build indices[\uf0c1](#build-indices \"Permalink to this heading\")\n\nmarch\\_index \\= VectorStoreIndex.from\\_documents(march\\_2022)\njune\\_index \\= VectorStoreIndex.from\\_documents(june\\_2022)\nsept\\_index \\= VectorStoreIndex.from\\_documents(sept\\_2022)\n\n## Build query engines[\uf0c1](#build-query-engines \"Permalink to this heading\")\n\nmarch\\_engine \\= march\\_index.as\\_query\\_engine(similarity\\_top\\_k\\=3)\njune\\_engine \\= june\\_index.as\\_query\\_engine(similarity\\_top\\_k\\=3)\nsept\\_engine \\= sept\\_index.as\\_query\\_engine(similarity\\_top\\_k\\=3)\n\nquery\\_engine\\_tools \\= \\[\n    QueryEngineTool(\n        query\\_engine\\=sept\\_engine,\n        metadata\\=ToolMetadata(\n            name\\=\"sept\\_22\",\n            description\\=(\n                \"Provides information about Uber quarterly financials ending\"\n                \" September 2022\"\n            ),\n        ),\n    ),\n    QueryEngineTool(\n        query\\_engine\\=june\\_engine,\n        metadata\\=ToolMetadata(\n            name\\=\"june\\_22\",\n            description\\=(\n                \"Provides information about Uber quarterly financials ending\"\n                \" June 2022\"\n            ),\n        ),\n    ),\n    QueryEngineTool(\n        query\\_engine\\=march\\_engine,\n        metadata\\=ToolMetadata(\n            name\\=\"march\\_22\",\n            description\\=(\n                \"Provides information about Uber quarterly financials ending\"\n                \" March 2022\"\n            ),\n        ),\n    ),\n\\]\n\ns\\_engine \\= SubQuestionQueryEngine.from\\_defaults(\n    query\\_engine\\_tools\\=query\\_engine\\_tools\n)\n\n## Run queries[\uf0c1](#run-queries \"Permalink to this heading\")\n\nresponse \\= s\\_engine.query(\n    \"Analyze Uber revenue growth over the latest two quarter filings\"\n)\n\nGenerated 2 sub questions.\n\\[sept\\_22\\] Q: What is the revenue growth of Uber for the quarter ending September 2022\n\\[sept\\_22\\] A: compared to the same period in 2021?\n\nThe revenue growth of Uber for the quarter ending September 2022 compared to the same period in 2021 is 72%.\n\\[june\\_22\\] Q: What is the revenue growth of Uber for the quarter ending June 2022\n\\[june\\_22\\] A: compared to the same period in 2021?\n\nThe revenue growth of Uber for the quarter ending June 2022 compared to the same period in 2021 is 105%.\n\nUber's revenue growth over the latest two quarter filings has been strong, with a 72% increase for the quarter ending September 2022 compared to the same period in 2021, and a 105% increase for the quarter ending June 2022 compared to the same period in 2021.\n\nresponse \\= s\\_engine.query(\n    \"Analyze change in macro environment over the 3 quarters\"\n)\n\nGenerated 3 sub questions.\n\\[sept\\_22\\] Q: What is the macro environment in September 2022\n\\[sept\\_22\\] A: \nThe macro environment in September 2022 is one of recovery from the impacts of the COVID-19 pandemic, with increases in Mobility Trip volumes, a $1.3 billion increase in Freight Gross Bookings resulting from the acquisition of Transplace, a $1.1 billion increase in Mobility revenue due to business model changes in the UK, and a $164 million increase in Delivery revenue due to an increase in certain Courier payments and incentives. Additionally, there was a $2.2 billion net increase in Mobility revenue due to business model changes in the UK and an accrual made for the resolution of historical claims in the UK relating to the classification of drivers, and a $751 million increase in Delivery revenue due to an increase in certain Courier payments and incentives.\n\\[june\\_22\\] Q: What is the macro environment in June 2022\n\\[june\\_22\\] A: \nIn June 2022, the macro environment is characterized by the continued impact of COVID-19 restrictions on global demand, the adoption of new accounting standards, and the potential for shifts in consumer travel patterns due to health concerns.\n\\[march\\_22\\] Q: What is the macro environment in March 2022\n\\[march\\_22\\] A: \nThe macro environment in March 2022 is uncertain, as the effects of the COVID-19 pandemic and the actions taken to mitigate it are still being felt. Travel restrictions, business restrictions, school closures, and limitations on social or public gatherings may still be in place in some regions, and the demand for services may still be affected.\n\nThe macro environment has seen a significant change over the three quarters from March 2022 to September 2022. In March 2022, the macro environment was uncertain due to the effects of the COVID-19 pandemic and the actions taken to mitigate it. By June 2022, the macro environment was characterized by the continued impact of COVID-19 restrictions on global demand, the adoption of new accounting standards, and the potential for shifts in consumer travel patterns due to health concerns. By September 2022, the macro environment had shifted to one of recovery from the impacts of the COVID-19 pandemic, with increases in Mobility Trip volumes, a $1.3 billion increase in Freight Gross Bookings resulting from the acquisition of Transplace, a $1.1 billion increase in Mobility revenue due to business model changes in the UK, and a $164 million increase in Delivery revenue due to an increase in certain Courier payments and incentives. Additionally, there was a $2.2 billion net increase in Mobility revenue due to business model changes in the UK and an accrual made for the resolution of historical claims in the UK relating to the classification of drivers, and a $751 million increase in Delivery revenue due to an increase in certain Courier payments and incentives.\n\nresponse \\= s\\_engine.query(\"How much cash did Uber have in sept 2022\")\n\nGenerated 1 sub questions.\n\\[sept\\_22\\] Q: How much cash did Uber have in September 2022\n\\[sept\\_22\\] A: \nUber had $4,865 million in cash in September 2022.\n\nUber had $4,865 million in cash in September 2022."
}